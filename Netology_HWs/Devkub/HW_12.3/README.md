# devops-netology
### performed by Kirill Karagodin
#### HW 12.3 Развертывание кластера на собственных серверах, лекция 1

#### Задание 1: Описать требования к кластеру

Сначала проекту необходимо определить требуемые ресурсы. Известно, что проекту нужны база данных, система 
кеширования, а само приложение состоит из бекенда и фронтенда. Опишите, какие ресурсы нужны, если известно:
- База данных должна быть отказоустойчивой. Потребляет 4 ГБ ОЗУ в работе, 1 ядро. 3 копии. 
- Кэш должен быть отказоустойчивый. Потребляет 4 ГБ ОЗУ в работе, 1 ядро. 3 копии. 
- Фронтенд обрабатывает внешние запросы быстро, отдавая статику. Потребляет не более 50 МБ ОЗУ на каждый экземпляр,
0.2 ядра. 5 копий. 
- Бекенд потребляет 600 МБ ОЗУ и по 1 ядру на копию. 10 копий.

#### Ответ

Минимальные ресурсы необходимые для разворачивания нод кластера

|               | CPU       | RAM      | HDD     |
| ------------- | --------- | -------- | ------- |
| Control Plane |   2 ядра  |     2 ГБ | 50 ГБ   |
| Worker Node   |   1 ядра  |     1 ГБ | 100 ГБ  |

Необходимые ресурсы для проекта

|          | CPU | RAM  | Replicas | Sum CPU | Sum RAM |
|----------|-----|------|----------|---------| ------- |
| БД       | 1   | 4    | 3        | 3       | 12      |
| Кеш      | 1   | 4    | 3        | 3       | 12      |
| Фронтенд | 0,2 | 0,05 | 5        | 1       | 0,25    |
| Бекенд   | 1   | 0,6  | 10       | 10      | 6       |

Расчёт количества рабочих нод кластера для проекта:
- Control Plane - 3 ноды, в минимальной конфигурации 2 CPU, 2 RAM
- Worker Node
  - БД - 3 ноды, конфигурация ноды 1 CPU, 4 RAM
  - Кеш - 3 ноды, конфигурация ноды 1 CPU, 4 RAM
  - Фронтенд - 2 ноды, конфигурация ноды 0,5 CPU, 0,125 RAM
  - Бекенд - 2 ноды, конфигурация ноды 5 CPU, 3 RAM

Суммарно для проекта требуется:
  - 17 CPU
  - 30,25 RAM

Для получения отказоустойчивости, исходя из суммарных значений, к этим значениям прибавим 40%,
что даст нам возможность не потерять в производительности при отказе 1 ноды.

Итоговые значения:

Расчёт ресурсов с учётом миграций и выхода ноды из строя
  - CPU: 17 + 40% = 24 (округлил в +)
  - RAM: 30,25 + 40% = 43 (округлил в +)

Расчёт одной ноды (известно что потребуется три рабочие ноды):
  - CPU: 24 / 3 = 8 + 1 (на работу самой ноды) = 9
  - RAM: 43 / 3 = 15 (округлил в +) +1 (на работу самой ноды) = 16

Итого
  - Нужно 3 рабоче ноды, характеристики одной ноды 9 CPU, 16 RAM
  - Нужно 3 управляющие ноды, характеристики одной ноды 2 CPU, 2 RAM
